/**
 * TinyMce ImageUpload plugin
 *
 * Copyright (c) http://www.leegtang.com 
 * 2014 by caigen 
 * Released under LGPL License.
 * 
 */
 

/**
 *  
 */
tinymce.PluginManager.add('imageTony', function(editor, url) {
	function fun(){
		editor.windowManager.open({
		title: 'ImageTony',
		url: url + '/dialog.html',
		width: 300,
		height: 200,
		buttons: [
			{
				text: 'Insert',
				onclick: function() {
					var  data = {}, dom = editor.dom;
					// Top most window object
					var win = editor.windowManager.getWindows()[0];
					
					data = {
							src:  win.getContentWindow().document.getElementById('content').value,
							alt: 'hahaha',
							width: win.getContentWindow().document.getElementById('width').value,
							height: win.getContentWindow().document.getElementById('height').value,
							//style: data.style,
							//"class": data["class"]
						};
					// Insert the contents of the dialog.html textarea into the editor
					editor.insertContent(
							dom.createHTML('img', data));

					// Close the window
					win.close();
				}
			},

			{text: 'Close', onclick: 'close'}
		]
	});
	}
	
	
	// Add a button that opens a window
	editor.addButton('imageTony', {
		text: 'UploadImage',
		icon: false,
		onclick: fun
	});

	// Adds a menu item to the tools menu
	editor.addMenuItem('imageTony', {
		text: 'UploadImage',
		context: 'tools',
		onclick:fun
	});
});